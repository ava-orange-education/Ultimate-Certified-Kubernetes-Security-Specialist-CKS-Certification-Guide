customRules:
  custom-rules.yaml: |-
    - rule: Host Network Used Outside Allowed Namespace
       desc: Detects the creation of a Pod with hostNetwork: true outside of the allowed kube-system namespace.
       condition: >
            k8s.pod.host_network and
            not k8s.pod.namespace = "kube-system" and
            k8s.audit.verb = "create" and
            k8s.audit.resource.resource = "pods"
       output: >
            A Pod with hostNetwork: true was created in a disallowed namespace
            (pod=%k8s.pod.name namespace=%k8s.pod.namespace user=%k8s.user.name).
       priority: WARNING
       tags: [kubernetes, hostnetwork, security]
